# Мартингалы {#martingales}

Конспект: Инна Маслова

дата: 14 ноября 2016 г.


## 14.1 Определение мартингала
### 14.1.1 Необходимые сведения перед основным определением
* Определение 1: Случайный процесс в дискретном времени - это последовательность случайных величин $x_1,x_2,x_3,\dots$
Формальная запись: ($x_n$).
* Определение 2: Фильтрация (поток $\sigma(x)$-алгебр) - последовательность $\sigma(x)$-алгебр $\mathcal{F_1}$,$\mathcal{F_2}$,$\mathcal{F_3}$,$\dots$ такая, что для любого $n$ $\mathcal{F_n}\subseteq \mathcal{F_{n+1}}$ (последующая $\sigma(x)$-алгебра содержит предыдущую).
* Определение 3: фильтрация $\mathcal{F_n}$ называется естественной фильтрацией для процесса ($x_n$), если все, что я знаю - значение $x$, то есть для любого $n$: $\mathcal{F_n}=\sigma(x_1,x_2,\dots,x_n)$ ( то есть в 1 день я знаю, что было в $x_1$,во 2 день- что было в $x_1$ и $x_2$ и так далее).

### 14.1.2 Определение мартингала
Процесс ($x_n$) называется мартингалом по отношению к фильтрации $\mathcal{F_n}$, если выполнены 2 условия:

1) для любого $n$  $x_n$ измерима относительно $\mathcal{F_n}$ (мне хватает $\mathcal{F_n}$ чтобы сказать, чему равно $x_n$) $\newcommand{\Expect}{\mathsf{E}}$

2) $\Expect (x_{n+1}|\mathcal{F_n})=x_n$

## 14.2 Задачи
### 14.2.1 Постановка задачи
Является ли процесс ($x_n$) мартингалом по отношению к фильтрации $\mathcal{F_n}$?

a) $z_1,z_2,\dots,z_n$ - независимы и $z_i\sim N(0,1)$, $x_n=\sum_{i=1}^n z_i$. Фильтрация: $\mathcal{F_n}=\sigma(x_1,x_2,\dots,x_n)$

b) $z_1,z_2,\dots,z_n$ - независимы и $z_i\sim U[0,1]$, $x_n=\sum_{i=1}^n z_i$. Фильтрация: $\mathcal{F_n}=\sigma(x_1,x_2,\dots,x_n)$

c) Есть колода карт. Всего 52 карты, 4 масти.Я открываю одну карту за другой и смотрю, какую карту я открыла. Пустьи $x_n$ - доля тузов в оставшейся колоде после открытия $n$ карт.$\mathcal{F_n}$ - знаю те карты, которые открыты. Рассмотрим, какие значения могут принимать $x_0$ и $x_1$.

$x_0=\dfrac4{52}$ 

После открытия 1 карты, получим, что значения, которые принимает $x_1$ будет либо туз (1), либо не туз (0). Тогда вероятность того, что открытая карта окажется тузом, равна $\frac4{52}$, так как всего 4 туза, а количество карт равно 52.

|   исход  |     не туз     |     туз     |
|----------|----------------|-------------|
|   $x_1$  |  $\dfrac4{52}$ |$\dfrac3{52}$|

d) Сколько элементов в $\mathcal{F_1}$ и $\mathcal{F_2}$? Понять, что больше, число элементарных частиц во Вселенной или число элементов в $\mathcal{F_2}$?

### 14.2.2 Решение
Для всех случаев нужно проверить выполнение 2 условий из определения мартингала.

**a) Рассмотрим 1 случай**

   1 условие: Я знаю $z_1,z_2,\dots,z_n$ и так как $x_n=\sum_{i=1}^n z_i$, то я знаю $x_n$.

   2 условие: $\Expect (x_{n+1}|\mathcal{F_n})=\Expect (z_1+z_2+\ldots+z_{n+1}|z_1,z_2,\dots,z_n)$=(знаю $z_1,z_2,\dots,z_n$, поэтому могу их вынести)=$z_1+z_2+\ldots+z_n+\Expect (z_{n+1}|z_1,z_2,\dots,z_n)=z_1+z_2+\ldots+z_n+\Expect (z_{n+1})=z_1+z_2+\ldots+z_n=x_n$
 
 Пояснения к вычислениям ко 2 условию: ($\Expect (z_{n+1})=0$ так как $z_i=N(0,1)$
 
 $\Expect (z_{n+1}|z_1,z_2,\dots,z_n)=\Expect (z_{n+1})$, так как случайные величины $z_1,z_2,\dots,z_n$ независимы) 
 
 Оба условия выполняются, значит, процесс ($x_n$) мартингал по отношению к фильтрации $\mathcal{F_n}$.

**b) Рассмотрим 2 случай**

   1 условие: Я знаю $z_1,z_2,\dots,z_n$ и так как $x_n=\sum_{i=1}^n z_i$, то я знаю $x_n$.

   2 условие: $\Expect (x_{n+1}|\mathcal{F_n})=\Expect (z_1+z_2+\ldots+z_{n+1}|z_1,z_2,\dots,z_n)$=(знаю $z_1,z_2,\dots,z_n$, поэтому могу их вынести)=$z_1+z_2+\ldots+z_n+\Expect (z_{n+1}|z_1,z_2,\dots,z_n)=z_1+z_2+\ldots+z_n+\Expect (z_{n+1})=z_1+z_2+\ldots+z_n+\dfrac{0+1}{2}=x_n+\dfrac12 \ne x_n$ 

2 условие не выполняется, значит, в этом случае процесс ($x_n$) не является мартингалом.

**c) Рассмотрим 3 случай**

   1 условие: выполнено, так как если я вижу открытые карты, то могу посчитать долю тузов среди неоткрытых, то есть могу посчитать $x_n$
   
   2 условие:
 Спрогнозируем долю тузов, когда открою следующую карту : $\Expect (x_{n+1}|\mathcal{F_n})$
 
 Сейчас: открыто $n$, закрыто 52-$n$
         
 Доля тузов среди закрытых карт: $x_n$
 
 Количество закрытых тузов: $x_n(52-n)$
 
 Тогда вероятность того, что при открытии $n+1$ карты будет туз равна доле тузов среди закрытых карт или $x_n$. Если карта - туз, то после её открытия доля тузов будет равна $x_{n+1}=\dfrac{(52-n)x_n-1}{51-n}$. Если же при открытии карта окажется не тузом, то $x_{n+1}=\dfrac{(52-n)x_n}{51-n}$. Ниже представлена таблица долями тузов и вероятностями исходов.
 
|  Исход  |           туз             |         не туз          |
|---------|---------------------------|-------------------------|
|$x_{n+1}$|$\dfrac{(52-n)x_n-1}{51-n}$|$\dfrac{(52-n)x_n}{51-n}$|
|   $p$   |            $x_n$          |          $1-x_n$        |
 
  

$\Expect (x_{n+1}|\mathcal{F_n})=x_n\dfrac{(52-n)x_n-1}{51-n}+(1-x_n)\dfrac{(52-n)x_n}{51-n}=\dfrac{52x_n^2-nx_n^2-x_n+52x_n-52x_n^2+nx_n^2}{51-n}=\dfrac{51x_n-nx_n}{51-n}=x_n$ 

2 условие выполняется.

Оба условия выполняются, значит, процесс ($x_n$) мартингал по отношению к фильтрации $\mathcal{F_n}$.

**d) Последнее задание**

$\mathcal{F_1}$ содержит 52 элементарных события (например, карта №1 - крести, карта №2 - туз пик и т.д.). Каждое событие включаем и не включаем, получим $card\mathcal{F_1}=2^{52}$

$card\mathcal{F_2}=2^{C_{52}^1C_{51}^1}=2^{52*51}=(4*10^{15})^{51}=4^{51}*10^{15*51}$ 

Число элементарных частиц во Вселенной $10^{81}$

$4^{51}*10^{15*51}\gg 10^{81}$

## 14.3 Зачем изучать мартингалы?
В реальности случайные процессы - не мартингалы. Можно сделать из процесса мартингал, изучить его (все просто считается) и сказать что-то об исходном процессе.

**Упражнение**

$z_1,z_2,\dots,z_n$ - независимы и $z_i\sim U[0,1]$, $x_n=\sum_{i=1}^n z_i$. Фильтрация: $\mathcal{F_n}=\sigma(x_1,x_2,\dots,x_n)$. Возьмем процесс $M_n=a^{x_n}$. Нужно подобрать число $a$ так, чтобы $(M_n)$ был мартингалом относительно фильтрации $\mathcal{F_n}$.

**Решение**

Простой случай: $a=1$. Действительно, $(M_n)=(1,1,1,1,\dots)$. Тогда $\Expect (M_{n+1}|\mathcal{F_n})=1=M_n$, а значит, $(M_n)$ - мартингал. 

Теперь попробуем найти $a \ne 1$. Для этого проверим выполнимость двух условий из определения мартингала.

1 условие: $M_n$ измерим относительно $\mathcal{F_n}$ при известном $a$

2 условие: $\Expect (M_{n+1}|\mathcal{F_n})=\Expect (a^{x_{n+1}}|\mathcal{F_n})=\Expect (a^{z_1+z_2+\ldots+z_{n+1}}|\mathcal{F_n})$=(знаю $z_1,z_2,\dots,z_n$, поэтому могу их вынести)=$a^{z_1+z_2+\dots+z_n}\Expect (a^{z_{n+1}}|\mathcal{F_n})=a^{x_n}\Expect (a^{z_{n+1}}|\mathcal{F_n})$=так как случайная величина $z_{n+1}$ не зависит от $z_1,z_2,\dots,z_n$ =$M_n\Expect (a^{z_{n+1}})$=(должно быть равно по определению мартингала)=$M_n$.Тогда

$\Expect (a^{z_{n+1}})=1$

$\Expect (a^{z_{n+1}})=\int\limits_0^1 a^t\,dt=1$

$\int\limits_0^1 e^{t*lna}\,dt=\left. \dfrac{e^{t*lna}}{lna}\right|_0^1=\dfrac{e^{lna}}{lna}-\dfrac1{lna}=\dfrac{e^{lna}-1}{lna}=\dfrac{a-1}{lna}=1$ => 

=> $a-1=lna$

Это уравнение имеет единственное решение $a=1$

Получаем:Процесс $M_n=a^{x_n}$ является мартингалом относительно фильтрации $\mathcal{F_n}$ только при $a=1$









